NS-OCP-006 — VERSION

0. Document Control

Program: Northfield Solidarity (NS)

Engine: OCP — Onchain Compute Plane

Document ID: NS-OCP-006-VERSION

Status: Draft v1

Depends On: NS-OCP-004-LIFECYCLE, NS-OCP-005-DECISION

Owner: OCP Lead (TBD)

1. Purpose

OCP versioning exists to make on-chain systems:

traceable (what changed, when, by whom)

safe to operate (clear upgrade/migration semantics)

auditable (provenance from code → build → deployment)

This document defines how OCP versions:

contract packages

deployments

configuration

upgrades/migrations

dApps and supporting services (indexers/relayers)

Note: The OCP lifecycle is defined in NS-OCP-004-LIFECYCLE. This document is the lifecycle’s version discipline.

2. Versioning Objects

OCP versions multiple layers simultaneously:

Contract Package Version — the source/build version of a contract module

Deployment Version — an instance of a package deployed on a specific network

System Release Version — a coordinated release across multiple contracts + config

Config Version — parameters that may materially alter behavior

Upgrade/Migration Version — governed changes applied to a deployment

dApp Version — client versions interfacing with contracts

Indexer/Relayer Version — off-chain services supporting runtime behavior

3. Contract Package Versioning (SemVer)

OCP contract packages use Semantic Versioning: MAJOR.MINOR.PATCH.

3.1 Meaning

PATCH: bug fix / non-breaking change

MINOR: backward-compatible feature addition

MAJOR: breaking change; migration likely

3.2 What Counts as “Breaking” in Contracts

Any of the following is considered breaking (MAJOR) unless explicitly proven otherwise:

storage layout changes (for upgradeable contracts)

changes to access control semantics

changes to economic behavior (fees, issuance, limits)

removal/renaming of public/external functions or events

changes that affect invariants or safety properties

3.3 Artifact Identity

Every build produces an immutable Build Artifact Set:

bytecode digest(s)

ABI(s)

compiler version + settings

source map metadata

dependency lock snapshot

These are recorded in the Contract Registry and linked to the package version.

4. Deployment Versioning

A deployment is versioned by:

Package Version (SemVer)

Network (chain ID / network label)

Deployment Timestamp

Deployment Record ID (registry primary key)

4.1 Canonical Deployment Identifier

OCP-DEPLOY-{PackageName}-{Network}-{Stage}#{N}

#{N} is a monotonically increasing deploy sequence for that package on that network.

Example:

OCP-DEPLOY-TreasuryVault-ARBMAIN-PROD#3

4.2 Re-deploys

If the same version is deployed again (e.g., new address), it is a new deployment with a new sequence number.

5. System Release Versioning

OCP defines a System Release as a coordinated rollout of:

one or more contract deployments/upgrades

configuration changes

dApp + indexer changes required for compatibility

5.1 Release SemVer (Recommended)

System releases may use SemVer as well, but must be at least:

Release ID: OCP-REL-YYYYMMDD-###

If SemVer is used:

System MAJOR: breaking user-facing or integration-breaking release

System MINOR: additive, compatible

System PATCH: bugfix only

5.2 Release Manifest

Every release must have a Release Manifest containing:

target networks

contract package versions + addresses (post-deploy)

config versions

signer/custody mechanism used

approvals (GGP/GGE)

rollback/containment notes

6. Configuration Versioning

Config is treated as code.

6.1 Config Objects

constructor/initializer params

on-chain parameters (fees, limits, allowlists)

off-chain parameters (RPC endpoints, indexer settings)

6.2 Version Rules

configs are hashed and stored as CFG-DIGEST

any material config change increments CFG version and requires an ADR if High/Critical

on-chain parameter changes must be executed via governed mechanisms (timelock/multisig)

7. Upgrade & Migration Versioning

Upgrades are first-class versioned events.

7.1 Upgrade Event Identifier

OCP-UPG-{SystemName}-{Network}-YYYYMMDD-###

7.2 Upgrade Types

Implementation Upgrade (proxy impl swap)

Parameter Upgrade (timelocked config change)

Migration Upgrade (new deploy + state migration)

7.3 Required Upgrade Record

Each upgrade record must include:

pre-state reference (current deployment record)

post-state reference (new impl/deploy records)

authority used (multisig/MPC/timelock)

approvals

validation steps + results

8. dApp Versioning

dApps use SemVer and must declare compatibility:

8.1 Compatibility Declaration

Each dApp release includes:

supported contract addresses per network (from registry)

supported ABI versions

feature flags / rollout notes

8.2 Wallet/UX Breaking Changes

Anything that changes signing semantics or user confirmation flows is treated as breaking unless explicitly proven safe.

9. Indexer / Relayer Versioning

Indexers and relayers are runtime-critical and versioned like services.

Required:

schema version (event schema)

indexing logic version

backward compatibility plan for schema changes

If event schema changes:

ship dual-write / dual-indexing where feasible

maintain query compatibility window (time-bounded)

10. Version Gates (Policy)

Versioning is enforced by gates:

10.1 Release Gates Require

package version bump aligned with change class

registry update must reference build artifact digests

release manifest must include exact versions + configs

10.2 High/Critical Additional Requirements

upgrade/migration rehearsal on TEST

external audit references (where required)

timelock enforcement for upgrades

11. Deprecation Policy

OCP supports explicit deprecation:

Deprecated: still supported, new work discouraged

Sunset: support ends after a date

Retired: decommissioned; use forbidden except for archival queries

Deprecation requires:

deprecation notice

migration plan

final registry state

12. Linkage to Registry and ADRs

Every versioned artifact must be linkable to:

Contract Registry (deployments, ownership, provenance)

OCP-ADR records (decision trail)

runbooks and dashboards

13. Next Document

NS-OCP-007 — DATAMODEL (schemas for registry, releases, artifacts, roles, signals)

